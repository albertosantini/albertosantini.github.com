---
layout: post
name: mround
title: MROUND
time: 2008-05-11 11:09:00.000000000 +02:00
---
MROUND using R programming language<br /><br /><span style="font-family:courier new;font-size:75%;"><br /><code><pre><br />#~ Title: MROUND Excel function simulation<br />#~<br />#~ mround function rounds a given number to the desired multiple:<br />#~ number is the number you want rounded and multiple is the the multiple<br />#~ to which you want to round the number.<br />#~<br />#~ Reference 1: http://office.microsoft.com/en-us/excel/HP052091851033.aspx<br />#~ Reference 2: http://www.gnome.org/projects/gnumeric/doc/gnumeric-MROUND.shtml<br />#~<br /><br />mround <- function(number, multiple) {<br />    # if number and multiple have different sign, returning an error.<br />    if (sign(number) != sign(multiple)) {<br />        stop("number and multiple have different sign")<br />    }<br /><br />    # Note that for rounding off a 5, the IEC 60559 standard is expected<br />    # to be used, ‘go to the even digit’. So we have to adjust the "0.5" case.<br />    n = number / multiple<br />    if (abs(n - trunc(n)) == 0.5) {<br />      if (sign(n) > 0) {<br />        n = n + 0.1<br />      } else {<br />        n = n - 0.1<br />      }<br />    }<br /><br />    round(n) * multiple<br />}<br /><br />#~ =MROUND(10, 3) Rounds 10 to a nearest multiple of 3 (9)<br />#~ =MROUND(-10, -3) Rounds -10 to a nearest multiple of -3 (-9)<br />#~ =MROUND(1.3, 0.2) Rounds 1.3 to a nearest multiple of 0.2 (1.4)<br />#~ =MROUND(5, -2) Returns an error, because -2 and 5 have different signs<br />#~ =MROUND(1.7, 0.2) equals 1.8<br />#~ =MROUND(321.123, 0.12) equals 321.12<br /><br />mround(10, 3) # 9<br />mround(-10, -3) # -9<br />mround(1.3, 0.2) # 1.4<br />mround(5, -2) # error<br />mround(1.7, 0.2) # 1.8<br />mround(321.123, 0.12) # 321.12<br />mround(1803.02, 50) # 1800<br />mround(193.51, 5) # 195<br />mround(3.47, 1) # 3<br /></code></pre><br /></span><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/5222581269807323470-6760477581058792855?l=albertosantini.blogspot.com' alt='' /></div>
