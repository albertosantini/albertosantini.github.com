<!DOCTYPE html>

<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Google GeoCode AutoComplete</title>

    <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/combo?3.4.1/build/cssreset/cssreset-min.css&3.4.1/build/cssfonts/cssfonts-min.css&3.4.1/build/cssbase/cssbase-min.css">
    <style>
        body {
            margin: auto;
            width: 960px;
        }
        #ac-input {
            width: 35em;
        }
        .yui3-aclist {
            width: 35em;
        }
    </style>
</head>

<body class="yui3-skin-sam">

<h1>Google GeoCode AutoComplete</h1>

<p>This example demonstrates how to provide autocomplete suggestions in geocode
example.
</p>

<label for="ac-input">Enter an address:</label><br>
<input id="ac-input" type="text">

<script src="http://yui.yahooapis.com/3.3.0/build/yui/yui-min.js"></script>
<script>
/*jslint sloppy:true */
/*global YUI, alert */

YUI({
    filter: 'raw'
}).use("autocomplete", function (Y) {
    var acNode = Y.one('#ac-input');

    acNode.plug(Y.Plugin.AutoComplete, {
        activateFirstItem: true,
        maxResults: 10,
        minQueryLength: 5,
        resultListLocator: function (res) {
            var r;

            if (res.error) {
                return [];
            }

            r = res.query.results.json;

            if (r.status !== "OK") {
                return [];
            }

            r = r.results;

            if (r.length > 0) {
                return r;
            } else {
                return [r];
            }
        },
        resultTextLocator: 'formatted_address',
        requestTemplate: function (query) {
            return encodeURI(query);
        },
        source: 'select * from json where ' +
            'url="http://maps.googleapis.com/maps/api/geocode/json?' +
            'sensor=false&' +
            'address={query}"',
        width: 'auto'
    });

    acNode.focus();

    acNode.ac.after('resultsChange', function () {
        var newWidth = this.get('boundingBox').get('offsetWidth');
        acNode.setStyle('width', Math.max(newWidth, 100));
    });

    acNode.ac.on('select', function (e) {
        alert(e.result.raw.formatted_address);
    });
});
</script>

</body>
</html>
